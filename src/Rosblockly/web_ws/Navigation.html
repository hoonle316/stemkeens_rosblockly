<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>ROS Web Dashboard</title><link rel="icon" href="https://i.ibb.co/k6zJ4sb/favicon-32x32.png" type="image/x-icon"><script src="https://unpkg.com/blockly@10.0.0/blockly.min.js"></script><script src="https://unpkg.com/blockly@10.0.0/javascript.min.js"></script><script src="three.min.js"></script><script src="TrackballControls.js"></script><script src="jquery-1.9.1.js"></script><script src="jquery.xml2json.js"></script><script src="parserobot.js"></script><script src="Coordinates.js"></script><script src="underscore.js"></script><script src="backbone.js"></script><script src="scene.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script><style>body{font-family:Arial,sans-serif;margin:0;padding:0;display:flex;flex-direction:column;height:100vh}.navbar{background-color:#f0d6a3;display:flex;align-items:center;padding:10px 20px;color:#333;font-weight:bold}.navbar .logo{display:flex;align-items:center}.navbar img{width:40px;height:40px;margin-right:10px}.navbar .title{font-size:20px}.navbar .buttons{margin-left:auto;display:flex;gap:10px}.buttons .btn{display:flex;align-items:center;padding:5px 10px;border-radius:5px;font-weight:bold;color:white;cursor:pointer}.btn.red{background-color:#dc3545}.btn span{margin-left:5px}#mainContent{display:flex;height:calc(100vh - 60px)}#blocklyDiv{height:100%;width:50%;border-right:1px solid #ccc}#previewDiv{height:100%;width:50%;position:relative}#container{width:100%;height:100%}#codeContainer{display:none;padding:10px;background-color:white;position:absolute;top:0;left:0;width:100%;height:100%;overflow-y:auto;z-index:10}#codeDiv{width:100%;height:calc(100% - 50px);border:1px solid #ccc;background-color:#f9f9f9;padding:10px;overflow-y:auto;white-space:pre-wrap}#codeContainer h2{margin-top:0}.close-btn{position:absolute;top:10px;right:20px;cursor:pointer;font-size:24px;color:#333}</style></head><body><div class="navbar"><div class="logo"><img src="https://i.ibb.co/CnbdrQh/Frame-1895.png" alt="Logo"><span class="title">Stemkeens Rosblockly</span></div><div class="buttons"><div class="btn red" onclick="exportToROS()" title="Export to ROS">🚀 <span>Export to ROS</span></div><div class="btn" onclick="showCode()" title="Show Code">💻 <span>Code</span></div><div class="btn" onclick="renderURDF()" title="Render URDF">💻 <span>Render</span></div></div></div><div id="mainContent"><div id="blocklyDiv"></div><div id="previewDiv"><div id="container"></div><div id="codeContainer"><span class="close-btn" onclick="closeCode()">&times;</span><h2>Generated URDF Code</h2><div id="codeDiv"></div></div></div></div><script>var workspace=Blockly.inject('blocklyDiv',{toolbox:`<xml><category name="World Link" colour="#1E88E5"><block type="world_link"></block></category><category name="Link" colour="#43A047"><block type="link"></block><block type="origin"></block><block type="material"></block></category><category name="Joint" colour="#FB8C00"><block type="joint"></block><block type="axis"></block><block type="limit"></block></category><category name="Geometry" colour="#8E24AA"><block type="box"></block><block type="sphere"></block><block type="cylinder"></block></category><category name="Basic Blocks" colour="#757575"><block type="start"></block></category><category name="ROS2 Control" colour="#FF5722"><block type="controller"></block><block type="controller_parameters"></block><block type="hardware_interface"></block><block type="transmission"></block><block type="joint_limits"></block></category></xml>`});Blockly.defineBlocksWithJsonArray([{type:"start",message0:"start",nextStatement:null,colour:330,tooltip:"The starting point of the block. Automatically adds a world link.",helpUrl:""},{type:"world_link",message0:"World Link (Fixed) %1",args0:[{type:"field_input",name:"LINK_NAME",text:"world"}],previousStatement:null,nextStatement:null,colour:210,tooltip:"Defines the root fixed link (World Link). No shapes allowed.",helpUrl:""},{type:"link",message0:"Link %1",args0:[{type:"field_input",name:"LINK_NAME",text:"link_name"}],message1:"Add shape %1",args1:[{type:"input_statement",name:"SHAPE"}],previousStatement:null,nextStatement:null,colour:120,tooltip:"Defines a link with an optional shape.",helpUrl:""},{type:"joint",message0:"Joint %1 to %2",args0:[{type:"field_input",name:"PARENT_LINK",text:"parent_link"},{type:"field_input",name:"CHILD_LINK",text:"child_link"}],message1:"Joint type %1",args1:[{type:"field_dropdown",name:"JOINT_TYPE",options:[["Fixed","fixed"],["Revolute","revolute"],["Prismatic","prismatic"],["Continuous","continuous"]]}],message2:"Add joint elements %1",args2:[{type:"input_statement",name:"JOINT_ELEMENTS"}],previousStatement:null,nextStatement:null,colour:60,tooltip:"Defines a joint connecting two links with a specified type.",helpUrl:""},{type:"box",message0:"Box with length %1 width %2 height %3",args0:[{type:"field_number",name:"LENGTH",value:1,min:0},{type:"field_number",name:"WIDTH",value:1,min:0},{type:"field_number",name:"HEIGHT",value:1,min:0}],previousStatement:null,nextStatement:null,colour:20,tooltip:"Defines a Box with specified dimensions",helpUrl:""},{type:"sphere",message0:"Sphere with radius %1",args0:[{type:"field_number",name:"RADIUS",value:1,min:0}],previousStatement:null,nextStatement:null,colour:20,tooltip:"Defines a Sphere with specified radius",helpUrl:""},{type:"cylinder",message0:"Cylinder with radius %1 height %2",args0:[{type:"field_number",name:"RADIUS",value:1,min:0},{type:"field_number",name:"HEIGHT",value:1,min:0}],previousStatement:null,nextStatement:null,colour:20,tooltip:"Defines a Cylinder with specified dimensions",helpUrl:""},{type:"material",message0:"Color RGBA %1 %2 %3 %4",args0:[{type:"field_number",name:"R",value:0.5,min:0,max:1},{type:"field_number",name:"G",value:0.5,min:0,max:1},{type:"field_number",name:"B",value:0.5,min:0,max:1},{type:"field_number",name:"A",value:1.0,min:0,max:1}],previousStatement:null,nextStatement:null,colour:300,tooltip:"Setting a Material",helpUrl:""},{type:"origin",message0:"Origin x %1 y %2 z %3 r %4 p %5 y %6",args0:[{type:"field_number",name:"X",value:0},{type:"field_number",name:"Y",value:0},{type:"field_number",name:"Z",value:0},{type:"field_number",name:"R",value:0},{type:"field_number",name:"P",value:0},{type:"field_number",name:"YAW",value:0}],previousStatement:null,nextStatement:null,colour:180,tooltip:"Set the origin position and rotation.",helpUrl:""},{type:"axis",message0:"Axis x %1 y %2 z %3",args0:[{type:"field_number",name:"X",value:0},{type:"field_number",name:"Y",value:0},{type:"field_number",name:"Z",value:1}],previousStatement:null,nextStatement:null,colour:200,tooltip:"Sets the axis of rotation or movement for the joint.",helpUrl:""},{type:"limit",message0:"lower %1 upper %2 effort %3 velocity %4",args0:[{type:"field_number",name:"LOWER",value:-1.57},{type:"field_number",name:"UPPER",value:1.57},{type:"field_number",name:"EFFORT",value:1.0},{type:"field_number",name:"VELOCITY",value:1.0}],previousStatement:null,nextStatement:null,colour:0,tooltip:"Set the motion limits of the joint.",helpUrl:""},{type:"controller",message0:"Controller %1",args0:[{type:"field_input",name:"CONTROLLER_NAME",text:"controller_name"}],message1:"Type %1",args1:[{type:"field_dropdown",name:"CONTROLLER_TYPE",options:[["trajectory_controller","trajectory_controller"],["position_controller","position_controller"],["velocity_controller","velocity_controller"],["effort_controller","effort_controller"]]}],message2:"Joints %1",args2:[{type:"input_statement",name:"JOINTS"}],previousStatement:null,nextStatement:null,colour:160,tooltip:"Defines a controller with specified type and joints.",helpUrl:""},{type:"joint_list",message0:"Joint %1",args0:[{type:"field_input",name:"JOINT_NAME",text:"joint_name"}],previousStatement:null,nextStatement:null,colour:120,tooltip:"Specifies a joint to be controlled.",helpUrl:""},{type:"hardware_interface",message0:"Joint %1 Interface %2",args0:[{type:"field_input",name:"JOINT_NAME",text:"joint_name"},{type:"field_dropdown",name:"INTERFACE_TYPE",options:[["PositionJointInterface","PositionJointInterface"],["VelocityJointInterface","VelocityJointInterface"],["EffortJointInterface","EffortJointInterface"],["JointStateInterface","JointStateInterface"]]}],previousStatement:null,nextStatement:null,colour:230,tooltip:"Defines the hardware interface for a joint.",helpUrl:""},{type:"controller_parameters",message0:"Controller Parameters for %1",args0:[{type:"field_input",name:"CONTROLLER_NAME",text:"controller_name"}],message1:"Sampling Time %1",args1:[{type:"field_number",name:"SAMPLING_TIME",value:0.1}],message2:"PID Values: P %1 I %2 D %3",args2:[{type:"field_number",name:"P_GAIN",value:1.0},{type:"field_number",name:"I_GAIN",value:0.0},{type:"field_number",name:"D_GAIN",value:0.1}],message3:"Update Rate %1",args3:[{type:"field_number",name:"UPDATE_RATE",value:100}],previousStatement:null,nextStatement:null,colour:200,tooltip:"Defines controller parameters such as sampling time, PID values, and update rate.",helpUrl:""},{type:"transmission",message0:"Transmission for %1",args0:[{type:"field_input",name:"TRANSMISSION_NAME",text:"transmission_name"}],message1:"Joint Name %1",args1:[{type:"field_input",name:"JOINT_NAME",text:"joint_name"}],message2:"Mechanical Reduction %1",args2:[{type:"field_number",name:"MECHANICAL_REDUCTION",value:1}],previousStatement:null,nextStatement:null,colour:180,tooltip:"Defines transmission with mechanical reduction for a joint.",helpUrl:""},{type:"joint_limits",message0:"Joint Limits for %1",args0:[{type:"field_input",name:"JOINT_NAME",text:"joint_name"}],message1:"Position: Lower %1 Upper %2",args1:[{type:"field_number",name:"LOWER",value:-1.57},{type:"field_number",name:"UPPER",value:1.57}],message2:"Effort %1 Velocity %2",args2:[{type:"field_number",name:"EFFORT",value:1.0},{type:"field_number",name:"VELOCITY",value:1.0}],previousStatement:null,nextStatement:null,colour:0,tooltip:"Defines the physical limits of a joint including position, effort, and velocity.",helpUrl:""}]);Blockly.JavaScript['start']=function(e){return""},Blockly.JavaScript['material']=function(e){var t=e.getFieldValue("R"),n=e.getFieldValue("G"),o=e.getFieldValue("B"),a=e.getFieldValue("A");return`<material name="color">\n<color rgba="${t} ${n} ${o} ${a}"/>\n</material>\n`},Blockly.JavaScript['limit']=function(e){var t=e.getFieldValue("LOWER"),n=e.getFieldValue("UPPER"),o=e.getFieldValue("EFFORT"),a=e.getFieldValue("VELOCITY");return`<limit lower="${t}" upper="${n}" effort="${o}" velocity="${a}"/>\n`},Blockly.JavaScript['origin']=function(e){var t=e.getFieldValue("X"),n=e.getFieldValue("Y"),o=e.getFieldValue("Z"),a=e.getFieldValue("R"),i=e.getFieldValue("P"),r=e.getFieldValue("YAW");return`<origin xyz="${t} ${n} ${o}" rpy="${a} ${i} ${r}"/>\n`},Blockly.JavaScript['axis']=function(e){var t=e.getFieldValue("X"),n=e.getFieldValue("Y"),o=e.getFieldValue("Z");return`<axis xyz="${t} ${n} ${o}"/>\n`},Blockly.JavaScript['world_link']=function(e){var t=e.getFieldValue("LINK_NAME");return`<link name="${t}">\n</link>\n`},Blockly.JavaScript['link']=function(e){var t=e.getFieldValue("LINK_NAME"),n=Blockly.JavaScript.statementToCode(e,"SHAPE");return`<link name="${t}">\n<visual>\n${n}</visual>\n<collision>\n${n}</collision>\n<inertial>\n<mass value="1.0"/>\n<inertia ixx="0.1" ixy="0" ixz="0" iyy="0.1" iyz="0" izz="0.1"/>\n</inertial>\n</link>\n`},Blockly.JavaScript['joint']=function(e){var t=e.getFieldValue("PARENT_LINK"),n=e.getFieldValue("CHILD_LINK"),o=e.getFieldValue("JOINT_TYPE"),a=Blockly.JavaScript.statementToCode(e,"JOINT_ELEMENTS");return`<joint name="${t}_to_${n}" type="${o}">\n<parent link="${t}"/>\n<child link="${n}"/>\n${a}\n</joint>\n`},Blockly.JavaScript['box']=function(e){var t=e.getFieldValue("LENGTH"),n=e.getFieldValue("WIDTH"),o=e.getFieldValue("HEIGHT");return`<geometry>\n<box size="${t} ${n} ${o}"/>\n</geometry>\n`},Blockly.JavaScript['sphere']=function(e){var t=e.getFieldValue("RADIUS");return`<geometry>\n<sphere radius="${t}"/>\n</geometry>\n`},Blockly.JavaScript['cylinder']=function(e){var t=e.getFieldValue("RADIUS"),n=e.getFieldValue("HEIGHT");return`<geometry>\n<cylinder radius="${t}" length="${n}"/>\n</geometry>\n`},Blockly.JavaScript['controller']=function(e){var t=e.getFieldValue("CONTROLLER_NAME"),n=e.getFieldValue("CONTROLLER_TYPE"),o=Blockly.JavaScript.statementToCode(e,"JOINTS");return`controller_manager:\nros__parameters:\n${t}:\ntype: ${n}\njoints: [${o.trim()}]\n`},Blockly.JavaScript['controller_parameters']=function(e){var t=e.getFieldValue("CONTROLLER_NAME"),n=e.getFieldValue("SAMPLING_TIME"),o=e.getFieldValue("P_GAIN"),a=e.getFieldValue("I_GAIN"),i=e.getFieldValue("D_GAIN"),r=e.getFieldValue("UPDATE_RATE");return`    ${t}:\nparameters:\nsampling_time: ${n}\npid: {p: ${o}, i: ${a}, d: ${i}}\nupdate_rate: ${r}\n`},Blockly.JavaScript['joint_list']=function(e){var t=e.getFieldValue("JOINT_NAME");return`<joint name="${t}"/>\n`},Blockly.JavaScript['hardware_interface']=function(e){var t=e.getFieldValue("HARDWARE_NAME"),n=e.getFieldValue("INTERFACE_TYPE"),o=e.getFieldValue("DRIVER_NAME");return`hardware_interface:\nros__parameters:\n${t}:\ntype: ${n}\ndriver: ${o}\n`},Blockly.JavaScript['transmission']=function(e){var t=e.getFieldValue("TRANSMISSION_NAME"),n=e.getFieldValue("JOINT_NAME"),o=e.getFieldValue("MECHANICAL_REDUCTION");return`transmission:\n- name: ${t}\ntype: transmission_interface/SimpleTransmission\njoints:\n- name: ${n}\nhardwareInterface: PositionJointInterface\nactuators:\n- name: ${t}_actuator\nmechanicalReduction: ${o}\n`},Blockly.JavaScript['joint_limits']=function(e){var t=e.getFieldValue("JOINT_NAME"),n=e.getFieldValue("LOWER"),o=e.getFieldValue("UPPER"),a=e.getFieldValue("EFFORT"),i=e.getFieldValue("VELOCITY");return`joint_limits_interface:\nros__parameters:\n${t}:\nlower: ${n}\nupper: ${o}\neffort: ${a}\nvelocity: ${i}\n`},Blockly.JavaScript['joint_list']=function(e){var t=e.getFieldValue("JOINT_NAME");return`'${t}', `};function updateCode(){var e=`<!-- URDF File Generated by Blockly -->\n<robot name="GeneratedRobot">\n`;e+=Blockly.JavaScript.workspaceToCode(workspace),e+=`</robot>`,document.getElementById("codeDiv").textContent=e,window.savedURDFCode=e,console.log("Generated URDF Code:",window.savedURDFCode)}function showCode(){document.getElementById("codeContainer").style.display="block"}function closeCode(){document.getElementById("codeContainer").style.display="none"}function loadURDF(e){for(;App.scene.children.length>0;)App.scene.remove(App.scene.children[0]);App.scene.add(App.light),App.scene.add(App.directionalLight);var t=$.parseXML(e);parseRobot(t,App.scene)}function renderURDF(){const e=window.urdfURL;e?fetch(e).then(e=>e.text()).then(e=>{loadURDF(e)}).catch(e=>{console.error("URDF 파일 로드 오류:",e),alert("URDF 파일 로드 중 오류가 발생했습니다.")}):alert("먼저 Export to ROS 버튼을 눌러 URDF 파일을 생성하세요.")}function exportToROS(){const e=new JSZip,t=e.folder("Stem_keens_pkg").folder("urdf"),n=window.savedURDFCode||"";if(!n)return void alert("먼저 블록을 조합하여 URDF 코드를 생성하세요.");const o=new Blob([n],{type:"text/xml"}),a=URL.createObjectURL(o);t.file("robot.urdf",n),e.generateAsync({type:"blob"}).then(function(e){const t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="Stem_keens_pkg.zip",t.click()}).catch(function(e){console.error("ZIP 생성 오류:",e),alert("ZIP 파일 생성 중 오류가 발생했습니다.")}),window.urdfURL=a}window.exportToROS=exportToROS,window.showCode=showCode,window.closeCode=closeCode,window.renderURDF=renderURDF,$(document).ready(function(){function e(){requestAnimationFrame(e),App.cameraControls.update(),App.renderer.render(App.scene,App.camera)}e(),window.addEventListener("resize",function(){var e=window.innerWidth/2,t=window.innerHeight-60;App.renderer.setSize(e,t),App.camera.aspect=e/t,App.camera.updateProjectionMatrix()})});</script></body></html>
